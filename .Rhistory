setwd("C:/Users/jpierzchlewicz/cars")
setwd("C:/Users/jpierzchlewicz/cars")
cars <- read.csv("otomoto.csv")
View(cars)
View(cars)
barplot(table(cars$country_of_origin))
barplot(table(cars$production_year))
barplot(table(cars$mileage))
hist(cars$mileage)
hist(as.vector(cars$mileage))
gsub(" km", "", cars$mileage)
gsub(" ", "", cars$mileage)
cars$mileage <- gsub(" km", "", cars$mileage)
cars$mileage <- gsub(" ", "", cars$mileage)
hist(cars$mileage)
summary(cars$mileage)
transform(cars, mileage = as.numeric(mileage))
cars <- transform(cars, mileage = as.numeric(mileage))
summary(cars$mileage)
hist(cars$mileage)
hist(cars$mileage, breaks=10)
hist(cars$mileage, breaks=5)
hist(cars$mileage, breaks=20)
hist(cars$mileage, breaks=30)
hist(cars$mileage(cars$mileage < 1000000), breaks=30)
hist(cars$mileage[cars$mileage < 1000000], breaks=30)
hist(cars$mileage[cars$mileage < 1000000], breaks=20)
hist(cars$mileage[cars$mileage < 500000], breaks=20)
hist(cars$mileage[cars$mileage < 100000], breaks=20)
hist(cars$mileage[cars$mileage < 500000], breaks=20)
library(rworldmap)
newmap <- getMap(resolution = "medium")
poland.limits <- geocode(c("Poland"))
plot(newmap, xlim=c(poland.limits$lon-5,poland.limits$lon+5), ylim=c(poland.limits$lat-5,poland.limits$lat+5), asp=1)
car_locations <- geocode(as.vector(cars$location))
points(car_locations$lon,car_locations$lat, col="red")
library(rworldmap)
library(ggmap)
newmap <- getMap(resolution = "medium")
poland.limits <- geocode(c("Poland"))
plot(newmap, xlim=c(poland.limits$lon-5,poland.limits$lon+5), ylim=c(poland.limits$lat-5,poland.limits$lat+5), asp=1)
car_locations <- geocode(as.vector(cars$location))
points(car_locations$lon,car_locations$lat, col="red")
plot(newmap, xlim=c(poland.limits$lon-4,poland.limits$lon+4), ylim=c(poland.limits$lat-5,poland.limits$lat+5), asp=1)
#car_locations <- geocode(as.vector(cars$location))
points(car_locations$lon,car_locations$lat, col="red")
plot(newmap, xlim=c(poland.limits$lon-3,poland.limits$lon+3), ylim=c(poland.limits$lat-5,poland.limits$lat+5), asp=1)
plot(newmap, xlim=c(poland.limits$lon-2,poland.limits$lon+2), ylim=c(poland.limits$lat-5,poland.limits$lat+5), asp=1)
plot(newmap, xlim=c(poland.limits$lon-2,poland.limits$lon+2), ylim=c(poland.limits$lat-5,poland.limits$lat+5), asp=1)
plot(newmap, xlim=c(poland.limits$lon-2,poland.limits$lon+2), ylim=c(poland.limits$lat-2,poland.limits$lat+2), asp=1)
plot(newmap, xlim=c(poland.limits$lon-3,poland.limits$lon+3), ylim=c(poland.limits$lat-3,poland.limits$lat+3), asp=1)
plot(newmap, xlim=c(poland.limits$lon-3,poland.limits$lon+3), ylim=c(poland.limits$lat-4,poland.limits$lat+4), asp=1)
plot(newmap, xlim=c(poland.limits$lon-3,poland.limits$lon+3), ylim=c(poland.limits$lat-3,poland.limits$lat+3), asp=1)
plot(newmap, xlim=c(poland.limits$lon-3,poland.limits$lon+3), ylim=c(poland.limits$lat-3,poland.limits$lat+3), asp=1)
points(car_locations$lon,car_locations$lat, col="red")
cars$country_of_origin[cars$country_of_origin == "Belgia"] <- Belgium
cars$country_of_origin[cars$country_of_origin == "Belgia"] <- "Belgium"
summary(cars$country_of_origin)
cars$country_of_origin[cars$country_of_origin == "Belgia"]
cars$country_of_origin <- as.character(cars$country_of_origin)
cars$country_of_origin[cars$country_of_origin == "Belgia"]
cars$country_of_origin[cars$country_of_origin == "Belgia"] <- "Belgium"
cars$country_of_origin[cars$country_of_origin == "Polska"] <- "Poland"
View(cars)
View(cars)
cars$country_of_origin[cars$country_of_origin == "Belgia"] <- "Belgium"
cars$country_of_origin[cars$country_of_origin == "Polska"] <- "Poland"
cars$country_of_origin[cars$country_of_origin == "Francja"] <- "France"
cars$country_of_origin[cars$country_of_origin == "Holandia"] <- "Holland"
cars$country_of_origin[cars$country_of_origin == "Niemcy"] <- "Germany"
cars$country_of_origin[cars$country_of_origin == "Stany Zjednoczone"] <- "USA"
cars$country_of_origin[cars$country_of_origin == "Szwajcaria"] <- "Switzerland"
cars$country_of_origin[cars$country_of_origin == "Szwecja"] <- "Sweden"
cars$country_of_origin[cars$country_of_origin == "Włochy"] <- "Italy"
barplot(table(cars$country_of_origin))
cars$country_of_origin[cars$country_of_origin == "WÅ‚ochy"] <- "Italy"
View(cars)
cars$country_of_origin[cars$country_of_origin == "Włochy"] <- "Italy"
cars <- read.csv("otomoto.csv")
cars$mileage <- gsub(" km", "", cars$mileage)
cars$mileage <- gsub(" ", "", cars$mileage)
cars <- transform(cars, mileage = as.numeric(mileage))
cars$country_of_origin <- as.character(cars$country_of_origin)
cars$country_of_origin[cars$country_of_origin == "Belgia"] <- "Belgium"
cars$country_of_origin[cars$country_of_origin == "Polska"] <- "Poland"
cars$country_of_origin[cars$country_of_origin == "Francja"] <- "France"
cars$country_of_origin[cars$country_of_origin == "Holandia"] <- "Holland"
cars$country_of_origin[cars$country_of_origin == "Niemcy"] <- "Germany"
cars$country_of_origin[cars$country_of_origin == "Stany Zjednoczone"] <- "USA"
cars$country_of_origin[cars$country_of_origin == "Szwajcaria"] <- "Switzerland"
cars$country_of_origin[cars$country_of_origin == "Szwecja"] <- "Sweden"
cars$country_of_origin[cars$country_of_origin == "Włochy"] <- "Italy"
View(cars)
cars <- read.csv("otomoto.csv")
cars$mileage <- gsub(" km", "", cars$mileage)
cars$mileage <- gsub(" ", "", cars$mileage)
cars <- transform(cars, mileage = as.numeric(mileage))
cars$country_of_origin <- as.character(cars$country_of_origin)
cars$country_of_origin[cars$country_of_origin == "Belgia"] <- "Belgium"
cars$country_of_origin[cars$country_of_origin == "Polska"] <- "Poland"
cars$country_of_origin[cars$country_of_origin == "Francja"] <- "France"
cars$country_of_origin[cars$country_of_origin == "Holandia"] <- "Holland"
cars$country_of_origin[cars$country_of_origin == "Niemcy"] <- "Germany"
cars$country_of_origin[cars$country_of_origin == "Stany Zjednoczone"] <- "USA"
cars$country_of_origin[cars$country_of_origin == "Szwajcaria"] <- "Switzerland"
cars$country_of_origin[cars$country_of_origin == "Szwecja"] <- "Sweden"
cars$country_of_origin[cars$country_of_origin == "Włochy"] <- "Italy"
View(cars)
barplot(table(cars$country_of_origin))
cars$country_of_origin[cars$country_of_origin == "WÅ‚ochy"] <- "Italy"
barplot(table(cars$country_of_origin))
cars$country_of_origin[cars$country_of_origin == "WÅ‚ochy"]
cars$country_of_origin[cars$country_of_origin == "Włochy"]
summary(cars$country_of_origin)
moto.csv")
cars$mileage <- gsub(" km", "", cars$mileage)
cars$mileage <- gsub(" ", "", cars$mileage)
cars <- transform(cars,
cars <- read.csv("otomoto.csv")
cars$mileage <- gsub(" km", "", cars$mileage)
cars$mileage <- gsub(" ", "", cars$mileage)
cars <- transform(cars, mileage = as.numeric(mileage))
cars <- read.csv("otomoto.csv")
cars$mileage <- gsub(" km", "", cars$mileage)
cars$mileage <- gsub(" ", "", cars$mileage)
cars <- transform(cars, mileage = as.numeric(mileage))
summary(cars$country_of_origin)
cars <- read.csv("otomoto.csv")
cars$mileage <- gsub(" km", "", cars$mileage)
cars$mileage <- gsub(" ", "", cars$mileage)
cars <- transform(cars, mileage = as.numeric(mileage))
cars$country_of_origin <- as.character(cars$country_of_origin)
cars$country_of_origin[cars$country_of_origin == "Belgia"] <- "Belgium"
cars$country_of_origin[cars$country_of_origin == "Polska"] <- "Poland"
cars$country_of_origin[cars$country_of_origin == "Francja"] <- "France"
cars$country_of_origin[cars$country_of_origin == "Holandia"] <- "Holland"
cars$country_of_origin[cars$country_of_origin == "Niemcy"] <- "Germany"
cars$country_of_origin[cars$country_of_origin == "Stany Zjednoczone"] <- "USA"
cars$country_of_origin[cars$country_of_origin == "Szwajcaria"] <- "Switzerland"
cars$country_of_origin[cars$country_of_origin == "Szwecja"] <- "Sweden"
barplot(table(cars$country_of_origin))
View(cars)
View(cars)
cars <- read.csv("otomoto.csv")
cars$mileage <- gsub(" km", "", cars$mileage)
cars$mileage <- gsub(" ", "", cars$mileage)
cars <- transform(cars, mileage = as.numeric(mileage))
# Italy had to be done manually since I was unable to solve the encoding problem in a timely fashion.
cars$country_of_origin <- as.character(cars$country_of_origin)
cars$country_of_origin[cars$country_of_origin == "Belgia"] <- "Belgium"
cars$country_of_origin[cars$country_of_origin == "Polska"] <- "Poland"
cars$country_of_origin[cars$country_of_origin == "Francja"] <- "France"
cars$country_of_origin[cars$country_of_origin == "Holandia"] <- "Holland"
cars$country_of_origin[cars$country_of_origin == "Niemcy"] <- "Germany"
cars$country_of_origin[cars$country_of_origin == "Stany Zjednoczone"] <- "USA"
cars$country_of_origin[cars$country_of_origin == "Szwajcaria"] <- "Switzerland"
cars$country_of_origin[cars$country_of_origin == "Szwecja"] <- "Sweden"
barplot(table(cars$country_of_origin))
barplot(table(cars$price))
hist(cars$price, breaks=10)
cars <- transform(cars, price = as.numeric(price))
hist(cars$price, breaks=10)
("otomoto.csv")
cars$mileage <- gsub(" km", "", cars$mileage)
cars$mileage <- gsub(" ", "", cars$mileage)
cars <- transform(cars, mileage =
cars <- read.csv("otomoto.csv")
cars$mileage <- gsub(" km", "", cars$mileage)
cars$mileage <- gsub(" ", "", cars$mileage)
cars <- transform(cars, mileage = as.numeric(mileage))
cars$price <- gsub(" ", "", cars$price)
cars <- transform(cars, price = as.numeric(price))
hist(cars$price, breaks=10)
hist(cars$price, breaks=20)
hist(cars$price, breaks=15)
install.package(ddply)
install.packages(ddply)
ddply
aggregate
help("aggregate")
aggregate(cars$price, list(cars$production_year), mean)
barplot(aggregate(cars$price, list(cars$production_year), mean))
barplot(table(aggregate(cars$price, list(cars$production_year), mean)))
help("barplot")
barplot(table(aggregate(cars$price, list(cars$production_year), mean)$x))
aggregate(cars$price, list(cars$production_year), mean)$x
help("barplot")
barplot(list(aggregate(cars$price, list(cars$production_year), mean)$x))
table(aggregate(cars$price, list(cars$production_year), mean)$x)
c(aggregate(cars$price, list(cars$production_year), mean)$x)
barplot(c(aggregate(cars$price, list(cars$production_year), mean)$x))
barplot(table(aggregate(cars$price, list(cars$production_year), mean)))
table(aggregate(cars$price, list(cars$production_year), mean))
barplot(c(aggregate(cars$price, list(cars$production_year), mean)$x))
help("barplot")
as.vector(aggregate(cars$price, list(cars$production_year), mean))
barplot(as.vector(aggregate(cars$price, list(cars$production_year), mean)$x))
barplot(as.vector(aggregate(cars$price, list(cars$production_year), mean)))
as.matrix(aggregate(cars$price, list(cars$production_year), mean))
barplot(as.matrix(aggregate(cars$price, list(cars$production_year), mean)))
barplot(as.vector(aggregate(cars$price, list(cars$production_year), mean)[,c("x","Group.1")]))
barplot(as.matrix(aggregate(cars$price, list(cars$production_year), mean)[,c("x","Group.1")]))
as.matrix(aggregate(cars$price, list(cars$production_year), mean)[,c("x","Group.1")])
aggregate(cars$price, list(cars$production_year), mean)[,c("x","Group.1")]
install.packages("lattice")
install.packages("lattice")
install.packages("lattice")
install.packages("lattice")
library(lattice)
prive_vs_year <- aggregate(cars$price, list(cars$production_year), mean)
table(prive_vs_year$Group.1, prive_vs_year$x)
table(prive_vs_year$x, prive_vs_year$Group.1)
barplot(table(prive_vs_year$x, prive_vs_year$Group.1))
barplot(table(prive_vs_year$Group.1, prive_vs_year$x))
as.matrix(prive_vs_year$x, prive_vs_year$Group.1)
as.matrix(prive_vs_year$Group.1, prive_vs_year$x)
barchart(prive_vs_year~Group.1,data=prive_vs_year$x, groups=prive_vs_year$Group.1)
barchart(x~Group.1, prive_vs_year, groups=prive_vs_year$Group.1)
barchart(Group.1~x, prive_vs_year, groups=prive_vs_year$Group.1)
barchart(Group.1~x, prive_vs_year, groups=prive_vs_year$x)
barchart(Group.1~x, prive_vs_year, groups=prive_vs_year$Group.1)
barchart(Group.1~x, data=prive_vs_year, groups=prive_vs_year$Group.1)
barchart(Group.1~x, data=prive_vs_year, groups=prive_vs_year$Group.1)
prive_vs_year
barchart(Group.1~x, data=prive_vs_year)
barchart(Group.1~x)
barchart(Group.1~x, data=prive_vs_year)
